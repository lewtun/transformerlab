---

title: Question Answering


keywords: fastai
sidebar: home_sidebar

summary: "Classes and functions for question answering tasks"
description: "Classes and functions for question answering tasks"
nb_path: "01_question-answering.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_question-answering.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">




 
 
<div id="c85ae4c3-5c43-492c-983d-ae7aaf00276f"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#c85ae4c3-5c43-492c-983d-ae7aaf00276f');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "8cf9b2f9b4044a7fa4646ecdc79fde8f"}
</script>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

<div class="output_area">




 
 
<div id="37f8085b-039c-438b-8c62-d7aba2dc682c"></div>
<div class="output_subarea output_widget_view ">
<script type="text/javascript">
var element = $('#37f8085b-039c-438b-8c62-d7aba2dc682c');
</script>
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "dc709e26d02e468f86dd3a517c8dee6d"}
</script>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Most of the classes and functions defined in this module are adapted from the following resources:</p>
<ul>
<li><a href="https://twitter.com/GuggerSylvain?s=20">Sylvain Gugger's</a> excellent <a href="https://github.com/huggingface/notebooks/blob/master/examples/question_answering.ipynb">tutorial</a> on extractive question answering</li>
<li>The scripts and modules from the <a href="https://github.com/huggingface/transformers/tree/master/examples/question-answering">question answering examples</a> in the <code>transformers</code> repository</li>
</ul>
<p>Compared to the results from HuggingFace's <code>run_qa.py</code> script, this implementation agrees to within 0.5% on the SQUAD v1 dataset:</p>
<table>
<thead><tr>
<th style="text-align:left">Implementation</th>
<th style="text-align:center">Exact Match</th>
<th style="text-align:center">F1</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">HuggingFace</td>
<td style="text-align:center">81.22</td>
<td style="text-align:center">88.52</td>
</tr>
<tr>
<td style="text-align:left">Ours</td>
<td style="text-align:center">80.82</td>
<td style="text-align:center">88.22</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dataset-preprocessing">Dataset preprocessing<a class="anchor-link" href="#Dataset-preprocessing"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="prepare_train_features" class="doc_header"><code>prepare_train_features</code><a href="https://github.com/lewtun/transformerlab/tree/master/transformerlab/question_answering.py#L17" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>prepare_train_features</code>(<strong><code>examples</code></strong>:<code>Union</code>[<code>str</code>, <code>List</code>[<code>str</code>], <code>List</code>[<code>List</code>[<code>str</code>]]], <strong><code>tokenizer</code></strong>:<code>PreTrainedTokenizer</code>, <strong><code>pad_on_right</code></strong>:<code>bool</code>, <strong><code>max_length</code></strong>:<code>int</code>=<em><code>384</code></em>, <strong><code>doc_stride</code></strong>:<code>int</code>=<em><code>128</code></em>)</p>
</blockquote>
<p>Tokenize and encode training examples in the SQuAD format</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="prepare_validation_features" class="doc_header"><code>prepare_validation_features</code><a href="https://github.com/lewtun/transformerlab/tree/master/transformerlab/question_answering.py#L68" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>prepare_validation_features</code>(<strong><code>examples</code></strong>, <strong><code>tokenizer</code></strong>, <strong><code>pad_on_right</code></strong>, <strong><code>max_length</code></strong>, <strong><code>doc_stride</code></strong>)</p>
</blockquote>
<p>Tokenize and encode validation examples in the SQuAD format</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="convert_examples_to_features" class="doc_header"><code>convert_examples_to_features</code><a href="https://github.com/lewtun/transformerlab/tree/master/transformerlab/question_answering.py#L96" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>convert_examples_to_features</code>(<strong><code>dataset</code></strong>, <strong><code>tokenizer</code></strong>, <strong><code>num_train_examples</code></strong>, <strong><code>num_eval_examples</code></strong>, <strong><code>max_length</code></strong>=<em><code>384</code></em>, <strong><code>doc_stride</code></strong>=<em><code>128</code></em>, <strong><code>seed</code></strong>=<em><code>42</code></em>)</p>
</blockquote>
<p>Tokenize and encode the training and validation examples in the SQuAD format</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoTokenizer</span>

<span class="n">num_train_examples</span> <span class="o">=</span> <span class="mi">800</span>
<span class="n">num_eval_examples</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">squad_ds</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;squad&#39;</span><span class="p">)</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s1">&#39;distilbert-base-uncased&#39;</span><span class="p">)</span>
<span class="n">train_ds</span><span class="p">,</span> <span class="n">eval_ds</span><span class="p">,</span> <span class="n">eval_examples</span> <span class="o">=</span> <span class="n">convert_examples_to_features</span><span class="p">(</span><span class="n">squad_ds</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">num_train_examples</span><span class="p">,</span> <span class="n">num_eval_examples</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">eval_examples</span><span class="o">.</span><span class="n">num_rows</span> <span class="o">==</span> <span class="n">num_eval_examples</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Metrics">Metrics<a class="anchor-link" href="#Metrics"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="squad_metrics" class="doc_header"><code>squad_metrics</code><a href="https://github.com/lewtun/transformerlab/tree/master/transformerlab/question_answering.py#L125" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>squad_metrics</code>(<strong><code>p</code></strong>:<code>EvalPrediction</code>)</p>
</blockquote>
<p>Compute the Exact Match and F1-score metrics on SQuAD</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Trainer">Trainer<a class="anchor-link" href="#Trainer"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="QuestionAnsweringTrainingArguments" class="doc_header"><code>class</code> <code>QuestionAnsweringTrainingArguments</code><a href="https://github.com/lewtun/transformerlab/tree/master/transformerlab/question_answering.py#L130" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>QuestionAnsweringTrainingArguments</code>(<strong>*<code>args</code></strong>, <strong><code>max_length</code></strong>=<em><code>384</code></em>, <strong><code>doc_stride</code></strong>=<em><code>128</code></em>, <strong><code>version_2_with_negative</code></strong>=<em><code>False</code></em>, <strong><code>null_score_diff_threshold</code></strong>=<em><code>0.0</code></em>, <strong><code>n_best_size</code></strong>=<em><code>20</code></em>, <strong><code>max_answer_length</code></strong>=<em><code>30</code></em>, <strong>**<code>kwargs</code></strong>) :: <code>TrainingArguments</code></p>
</blockquote>
<p>TrainingArguments is the subset of the arguments we use in our example scripts <strong>which relate to the training loop
itself</strong>.</p>
<p>Using :class:<code>~transformers.HfArgumentParser</code> we can turn this class into <code>argparse
&lt;https://docs.python.org/3/library/argparse.html#module-argparse&gt;</code>__ arguments that can be specified on the command
line.</p>
<p>Parameters:
    output_dir (:obj:<code>str</code>):
        The output directory where the model predictions and checkpoints will be written.
    overwrite_output_dir (:obj:<code>bool</code>, <code>optional</code>, defaults to :obj:<code>False</code>):
        If :obj:<code>True</code>, overwrite the content of the output directory. Use this to continue training if
        :obj:<code>output_dir</code> points to a checkpoint directory.
    do_train (:obj:<code>bool</code>, <code>optional</code>, defaults to :obj:<code>False</code>):
        Whether to run training or not. This argument is not directly used by :class:<code>~transformers.Trainer</code>, it's
        intended to be used by your training/evaluation scripts instead. See the <code>example scripts
        &lt;https://github.com/huggingface/transformers/tree/master/examples&gt;</code><strong> for more details.
    do_eval (:obj:<code>bool</code>, <code>optional</code>):
        Whether to run evaluation on the validation set or not. Will be set to :obj:<code>True</code> if
        :obj:<code>evaluation_strategy</code> is different from :obj:<code>"no"</code>. This argument is not directly used by
        :class:<code>~transformers.Trainer</code>, it's intended to be used by your training/evaluation scripts instead. See
        the <code>example scripts &lt;https://github.com/huggingface/transformers/tree/master/examples&gt;</code></strong> for more
        details.
    do_predict (:obj:<code>bool</code>, <code>optional</code>, defaults to :obj:<code>False</code>):
        Whether to run predictions on the test set or not. This argument is not directly used by
        :class:<code>~transformers.Trainer</code>, it's intended to be used by your training/evaluation scripts instead. See
        the <code>example scripts &lt;https://github.com/huggingface/transformers/tree/master/examples&gt;</code>__ for more
        details.
    evaluation_strategy (:obj:<code>str</code> or :class:<code>~transformers.trainer_utils.EvaluationStrategy</code>, <code>optional</code>, defaults to :obj:<code>"no"</code>):
        The evaluation strategy to adopt during training. Possible values are:</p>

<pre><code>        * :obj:`"no"`: No evaluation is done during training.
        * :obj:`"steps"`: Evaluation is done (and logged) every :obj:`eval_steps`.
        * :obj:`"epoch"`: Evaluation is done at the end of each epoch.

prediction_loss_only (:obj:`bool`, `optional`, defaults to `False`):
    When performing evaluation and generating predictions, only returns the loss.
per_device_train_batch_size (:obj:`int`, `optional`, defaults to 8):
    The batch size per GPU/TPU core/CPU for training.
per_device_eval_batch_size (:obj:`int`, `optional`, defaults to 8):
    The batch size per GPU/TPU core/CPU for evaluation.
gradient_accumulation_steps (:obj:`int`, `optional`, defaults to 1):
    Number of updates steps to accumulate the gradients for, before performing a backward/update pass.

    .. warning::

        When using gradient accumulation, one step is counted as one step with backward pass. Therefore,
        logging, evaluation, save will be conducted every ``gradient_accumulation_steps * xxx_step`` training
        examples.
eval_accumulation_steps (:obj:`int`, `optional`):
    Number of predictions steps to accumulate the output tensors for, before moving the results to the CPU. If
    left unset, the whole predictions are accumulated on GPU/TPU before being moved to the CPU (faster but
    requires more memory).
learning_rate (:obj:`float`, `optional`, defaults to 5e-5):
    The initial learning rate for Adam.
weight_decay (:obj:`float`, `optional`, defaults to 0):
    The weight decay to apply (if not zero).
adam_beta1 (:obj:`float`, `optional`, defaults to 0.9):
    The beta1 hyperparameter for the Adam optimizer.
adam_beta2 (:obj:`float`, `optional`, defaults to 0.999):
    The beta2 hyperparameter for the Adam optimizer.
adam_epsilon (:obj:`float`, `optional`, defaults to 1e-8):
    The epsilon hyperparameter for the Adam optimizer.
max_grad_norm (:obj:`float`, `optional`, defaults to 1.0):
    Maximum gradient norm (for gradient clipping).
num_train_epochs(:obj:`float`, `optional`, defaults to 3.0):
    Total number of training epochs to perform (if not an integer, will perform the decimal part percents of
    the last epoch before stopping training).
max_steps (:obj:`int`, `optional`, defaults to -1):
    If set to a positive number, the total number of training steps to perform. Overrides
    :obj:`num_train_epochs`.
warmup_steps (:obj:`int`, `optional`, defaults to 0):
    Number of steps used for a linear warmup from 0 to :obj:`learning_rate`.
logging_dir (:obj:`str`, `optional`):
    `TensorBoard &lt;https://www.tensorflow.org/tensorboard&gt;`__ log directory. Will default to
    `runs/**CURRENT_DATETIME_HOSTNAME**`.
logging_first_step (:obj:`bool`, `optional`, defaults to :obj:`False`):
    Whether to log and evaluate the first :obj:`global_step` or not.
logging_steps (:obj:`int`, `optional`, defaults to 500):
    Number of update steps between two logs.
save_steps (:obj:`int`, `optional`, defaults to 500):
    Number of updates steps before two checkpoint saves.
save_total_limit (:obj:`int`, `optional`):
    If a value is passed, will limit the total amount of checkpoints. Deletes the older checkpoints in
    :obj:`output_dir`.
no_cuda (:obj:`bool`, `optional`, defaults to :obj:`False`):
    Whether to not use CUDA even when it is available or not.
seed (:obj:`int`, `optional`, defaults to 42):
    Random seed for initialization.
fp16 (:obj:`bool`, `optional`, defaults to :obj:`False`):
    Whether to use 16-bit (mixed) precision training (through NVIDIA Apex) instead of 32-bit training.
fp16_opt_level (:obj:`str`, `optional`, defaults to 'O1'):
    For :obj:`fp16` training, Apex AMP optimization level selected in ['O0', 'O1', 'O2', and 'O3']. See details
    on the `Apex documentation &lt;https://nvidia.github.io/apex/amp.html&gt;`__.
local_rank (:obj:`int`, `optional`, defaults to -1):
    Rank of the process during distributed training.
tpu_num_cores (:obj:`int`, `optional`):
    When training on TPU, the number of TPU cores (automatically passed by launcher script).
debug (:obj:`bool`, `optional`, defaults to :obj:`False`):
    When training on TPU, whether to print debug metrics or not.
dataloader_drop_last (:obj:`bool`, `optional`, defaults to :obj:`False`):
    Whether to drop the last incomplete batch (if the length of the dataset is not divisible by the batch size)
    or not.
eval_steps (:obj:`int`, `optional`):
    Number of update steps between two evaluations if :obj:`evaluation_strategy="steps"`. Will default to the
    same value as :obj:`logging_steps` if not set.
dataloader_num_workers (:obj:`int`, `optional`, defaults to 0):
    Number of subprocesses to use for data loading (PyTorch only). 0 means that the data will be loaded in the
    main process.
past_index (:obj:`int`, `optional`, defaults to -1):
    Some models like :doc:`TransformerXL &lt;../model_doc/transformerxl&gt;` or :doc`XLNet &lt;../model_doc/xlnet&gt;` can
    make use of the past hidden states for their predictions. If this argument is set to a positive int, the
    ``Trainer`` will use the corresponding output (usually index 2) as the past state and feed it to the model
    at the next training step under the keyword argument ``mems``.
run_name (:obj:`str`, `optional`):
    A descriptor for the run. Typically used for `wandb &lt;https://www.wandb.com/&gt;`_ logging.
disable_tqdm (:obj:`bool`, `optional`):
    Whether or not to disable the tqdm progress bars and table of metrics produced by
    :class:`~transformers.notebook.NotebookTrainingTracker` in Jupyter Notebooks. Will default to :obj:`True`
    if the logging level is set to warn or lower (default), :obj:`False` otherwise.
remove_unused_columns (:obj:`bool`, `optional`, defaults to :obj:`True`):
    If using :obj:`datasets.Dataset` datasets, whether or not to automatically remove the columns unused by the
    model forward method.

    (Note that this behavior is not implemented for :class:`~transformers.TFTrainer` yet.)
label_names (:obj:`List[str]`, `optional`):
    The list of keys in your dictionary of inputs that correspond to the labels.

    Will eventually default to :obj:`["labels"]` except if the model used is one of the
    :obj:`XxxForQuestionAnswering` in which case it will default to :obj:`["start_positions",
    "end_positions"]`.
load_best_model_at_end (:obj:`bool`, `optional`, defaults to :obj:`False`):
    Whether or not to load the best model found during training at the end of training.

    .. note::

        When set to :obj:`True`, the parameters :obj:`save_steps` will be ignored and the model will be saved
        after each evaluation.
metric_for_best_model (:obj:`str`, `optional`):
    Use in conjunction with :obj:`load_best_model_at_end` to specify the metric to use to compare two different
    models. Must be the name of a metric returned by the evaluation with or without the prefix :obj:`"eval_"`.
    Will default to :obj:`"loss"` if unspecified and :obj:`load_best_model_at_end=True` (to use the evaluation
    loss).

    If you set this value, :obj:`greater_is_better` will default to :obj:`True`. Don't forget to set it to
    :obj:`False` if your metric is better when lower.
greater_is_better (:obj:`bool`, `optional`):
    Use in conjunction with :obj:`load_best_model_at_end` and :obj:`metric_for_best_model` to specify if better
    models should have a greater metric or not. Will default to:

    - :obj:`True` if :obj:`metric_for_best_model` is set to a value that isn't :obj:`"loss"` or
      :obj:`"eval_loss"`.
    - :obj:`False` if :obj:`metric_for_best_model` is not set, or set to :obj:`"loss"` or :obj:`"eval_loss"`.
model_parallel (:obj:`bool`, `optional`, defaults to :obj:`False`):
    If there is more than one device, whether to use model parallelism to distribute the model's modules across
    devices or not.
ignore_skip_data (:obj:`bool`, `optional`, defaults to :obj:`False`):
    When resuming training, whether or not to skip the epochs and batches to get the data loading at the same
    stage as in the previous training. If set to :obj:`True`, the training will begin faster (as that skipping
    step can take a long time) but will not yield the same results as the interrupted training would have.
fp16_backend (:obj:`str`, `optional`, defaults to :obj:`"auto"`):
    The backend to use for mixed precision training. Must be one of :obj:`"auto"`, :obj:`"amp"` or
    :obj:`"apex"`. :obj:`"auto"` will use AMP or APEX depending on the PyTorch version detected, while the
    other choices will force the requested backend.
sharded_ddp (:obj:`bool`, `optional`, defaults to :obj:`False`):
    Use Sharded DDP training from `FairScale &lt;https://github.com/facebookresearch/fairscale&gt;`__ (in distributed
    training only). This is an experimental feature.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="QuestionAnsweringTrainer" class="doc_header"><code>class</code> <code>QuestionAnsweringTrainer</code><a href="https://github.com/lewtun/transformerlab/tree/master/transformerlab/question_answering.py#L144" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>QuestionAnsweringTrainer</code>(<strong>*<code>args</code></strong>, <strong><code>eval_examples</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>) :: <code>Trainer</code></p>
</blockquote>
<p>Trainer is a simple but feature-complete training and eval loop for PyTorch, optimized for ðŸ¤— Transformers.</p>
<p>Args:
    model (:class:<code>~transformers.PreTrainedModel</code> or :obj:<code>torch.nn.Module</code>, <code>optional</code>):
        The model to train, evaluate or use for predictions. If not provided, a <code>model_init</code> must be passed.</p>

<pre><code>    .. note::

        :class:`~transformers.Trainer` is optimized to work with the :class:`~transformers.PreTrainedModel`
        provided by the library. You can still use your own models defined as :obj:`torch.nn.Module` as long as
        they work the same way as the ðŸ¤— Transformers models.
args (:class:`~transformers.TrainingArguments`, `optional`):
    The arguments to tweak for training. Will default to a basic instance of
    :class:`~transformers.TrainingArguments` with the ``output_dir`` set to a directory named `tmp_trainer` in
    the current directory if not provided.
data_collator (:obj:`DataCollator`, `optional`):
    The function to use to form a batch from a list of elements of :obj:`train_dataset` or :obj:`eval_dataset`.
    Will default to :func:`~transformers.default_data_collator` if no ``tokenizer`` is provided, an instance of
    :func:`~transformers.DataCollatorWithPadding` otherwise.
train_dataset (:obj:`torch.utils.data.dataset.Dataset`, `optional`):
    The dataset to use for training. If it is an :obj:`datasets.Dataset`, columns not accepted by the
    ``model.forward()`` method are automatically removed.
eval_dataset (:obj:`torch.utils.data.dataset.Dataset`, `optional`):
     The dataset to use for evaluation. If it is an :obj:`datasets.Dataset`, columns not accepted by the
     ``model.forward()`` method are automatically removed.
tokenizer (:class:`PreTrainedTokenizerBase`, `optional`):
    The tokenizer used to preprocess the data. If provided, will be used to automatically pad the inputs the
    maximum length when batching inputs, and it will be saved along the model to make it easier to rerun an
    interrupted training or reuse the fine-tuned model.
model_init (:obj:`Callable[[], PreTrainedModel]`, `optional`):
    A function that instantiates the model to be used. If provided, each call to
    :meth:`~transformers.Trainer.train` will start from a new instance of the model as given by this function.

    The function may have zero argument, or a single one containing the optuna/Ray Tune trial object, to be
    able to choose different architectures according to hyper parameters (such as layer count, sizes of inner
    layers, dropout probabilities etc).
compute_metrics (:obj:`Callable[[EvalPrediction], Dict]`, `optional`):
    The function that will be used to compute metrics at evaluation. Must take a
    :class:`~transformers.EvalPrediction` and return a dictionary string to metric values.
callbacks (List of :obj:`~transformers.TrainerCallback`, `optional`):
    A list of callbacks to customize the training loop. Will add those to the list of default callbacks
    detailed in :doc:`here &lt;callback&gt;`.

    If you want to remove one of the default callbacks used, use the :meth:`Trainer.remove_callback` method.
optimizers (:obj:`Tuple[torch.optim.Optimizer, torch.optim.lr_scheduler.LambdaLR`, `optional`): A tuple
    containing the optimizer and the scheduler to use. Will default to an instance of
    :class:`~transformers.AdamW` on your model and a scheduler given by
    :func:`~transformers.get_linear_schedule_with_warmup` controlled by :obj:`args`.</code></pre>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following example shows how the classes and functions in this module can be combined to fine-tune on the SQuAD v1 dataset. The first thing we need to do is grab the dataset:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datasets</span> <span class="kn">import</span> <span class="n">load_dataset</span>

<span class="n">squad</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;squad&#39;</span><span class="p">)</span>
<span class="n">squad</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DatasetDict({
    train: Dataset({
        features: [&#39;id&#39;, &#39;title&#39;, &#39;context&#39;, &#39;question&#39;, &#39;answers&#39;],
        num_rows: 87599
    })
    validation: Dataset({
        features: [&#39;id&#39;, &#39;title&#39;, &#39;context&#39;, &#39;question&#39;, &#39;answers&#39;],
        num_rows: 10570
    })
})</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For each example, the key information is contained in the <code>context</code>, <code>question</code>, and <code>answer</code> fields:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">squad</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;answers&#39;: {&#39;answer_start&#39;: [515], &#39;text&#39;: [&#39;Saint Bernadette Soubirous&#39;]},
 &#39;context&#39;: &#39;Architecturally, the school has a Catholic character. Atop the Main Building\&#39;s gold dome is a golden statue of the Virgin Mary. Immediately in front of the Main Building and facing it, is a copper statue of Christ with arms upraised with the legend &#34;Venite Ad Me Omnes&#34;. Next to the Main Building is the Basilica of the Sacred Heart. Immediately behind the basilica is the Grotto, a Marian place of prayer and reflection. It is a replica of the grotto at Lourdes, France where the Virgin Mary reputedly appeared to Saint Bernadette Soubirous in 1858. At the end of the main drive (and in a direct line that connects through 3 statues and the Gold Dome), is a simple, modern stone statue of Mary.&#39;,
 &#39;id&#39;: &#39;5733be284776f41900661182&#39;,
 &#39;question&#39;: &#39;To whom did the Virgin Mary allegedly appear in 1858 in Lourdes France?&#39;,
 &#39;title&#39;: &#39;University_of_Notre_Dame&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we need to tokenize and encode these texts. The following code does the job:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoTokenizer</span>

<span class="n">model_checkpoint</span> <span class="o">=</span> <span class="s1">&#39;bert-base-uncased&#39;</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_checkpoint</span><span class="p">)</span>

<span class="n">num_train_examples</span> <span class="o">=</span> <span class="mi">1600</span>
<span class="n">num_eval_examples</span> <span class="o">=</span> <span class="mi">320</span>
<span class="n">train_ds</span><span class="p">,</span> <span class="n">eval_ds</span><span class="p">,</span> <span class="n">eval_examples</span> <span class="o">=</span> <span class="n">convert_examples_to_features</span><span class="p">(</span><span class="n">squad_ds</span><span class="p">,</span> <span class="n">tokenizer</span><span class="p">,</span> <span class="n">num_train_examples</span><span class="p">,</span> <span class="n">num_eval_examples</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final step is to configure and instantiate the trainer using the same settings as those decribed in the <code>transformers</code> <a href="https://github.com/huggingface/transformers/tree/master/examples/question-answering#squad">examples</a>. We'll use the <code>model_init</code> argument to ensure that the model is initialised with the same random weights:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoModelForQuestionAnswering</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running on device: </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">model_init</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">AutoModelForQuestionAnswering</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">model_checkpoint</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Running on device: cuda
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we just need to specify the hyperparameters and data collator for padding</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">3e-5</span>
<span class="n">num_train_epochs</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">logging_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_ds</span><span class="p">)</span> <span class="o">//</span> <span class="n">batch_size</span>

<span class="n">args</span> <span class="o">=</span> <span class="n">QuestionAnsweringTrainingArguments</span><span class="p">(</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;checkpoints&#39;</span><span class="p">,</span>
    <span class="n">evaluation_strategy</span><span class="o">=</span><span class="s1">&#39;epoch&#39;</span><span class="p">,</span>
    <span class="n">num_train_epochs</span><span class="o">=</span><span class="n">num_train_epochs</span><span class="p">,</span>
    <span class="n">per_device_train_batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">3e-5</span><span class="p">,</span>
    <span class="n">logging_steps</span><span class="o">=</span><span class="n">logging_steps</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">QuestionAnsweringTrainer</span><span class="p">(</span>
    <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
    <span class="n">model_init</span><span class="o">=</span><span class="n">model_init</span><span class="p">,</span>
    <span class="n">train_dataset</span><span class="o">=</span><span class="n">train_ds</span><span class="p">,</span>
    <span class="n">eval_dataset</span><span class="o">=</span><span class="n">eval_ds</span><span class="p">,</span>
    <span class="n">eval_examples</span><span class="o">=</span><span class="n">eval_examples</span><span class="p">,</span>
    <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and perform the fine-tuning:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

    <div>
        <style>
            /* Turns off some styling */
            progress {
                /* gets rid of default border in Firefox and Opera. */
                border: none;
                /* Needs to be in here for Safari polyfill so background images work as expected. */
                background-size: auto;
            }
        </style>
      
      <progress value='14754' max='14754' style='width:300px; height:20px; vertical-align: middle;'></progress>
      [14754/14754 2:58:54, Epoch 2/2]
    </div>
    <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>Epoch</th>
      <th>Training Loss</th>
      <th>Validation Loss</th>
      <th>Exact Match</th>
      <th>F1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1.000000</td>
      <td>1.266106</td>
      <td>No log</td>
      <td>79.309366</td>
      <td>86.817847</td>
    </tr>
    <tr>
      <td>2.000000</td>
      <td>0.720876</td>
      <td>No log</td>
      <td>80.823084</td>
      <td>88.228499</td>
    </tr>
  </tbody>
</table><p>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

<script type="application/vnd.jupyter.widget-state+json">
{"state": {"1d2bc68dbfb74ddebb128cd63af4c390": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dc419b60dab84016ac27411608e8adaa": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": "initial"}}, "277abfbae7f745f3a229b3ab97b35b17": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "Downloading: ", "description_tooltip": null, "layout": "IPY_MODEL_1d2bc68dbfb74ddebb128cd63af4c390", "max": 1616.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_dc419b60dab84016ac27411608e8adaa", "value": 1616.0}}, "70ef7a049f204e8abe2fe775c98882bb": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "0ffe896fdf594530a87e7db00fa5863a": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "48e01ff84e244b1e995cbe3af1352605": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_70ef7a049f204e8abe2fe775c98882bb", "placeholder": "\u200b", "style": "IPY_MODEL_0ffe896fdf594530a87e7db00fa5863a", "value": " 4.02k/? [00:00&lt;00:00, 4.34kB/s]"}}, "562b135b8bc34fd0a34eae01bdea9638": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8cf9b2f9b4044a7fa4646ecdc79fde8f": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_277abfbae7f745f3a229b3ab97b35b17", "IPY_MODEL_48e01ff84e244b1e995cbe3af1352605"], "layout": "IPY_MODEL_562b135b8bc34fd0a34eae01bdea9638"}}, "beb16519884942d1a855d963c2cc7207": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2f39d2e96bc047348e36daa799c0d8a0": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "bar_color": null, "description_width": "initial"}}, "7128770925c6446bab7f6d0a676b4159": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "ProgressView", "bar_style": "success", "description": "Downloading: ", "description_tooltip": null, "layout": "IPY_MODEL_beb16519884942d1a855d963c2cc7207", "max": 1195.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_2f39d2e96bc047348e36daa799c0d8a0", "value": 1195.0}}, "4cf7707cc5b9461093ead9fb2ae9e66c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "18c3d5f5ee774b4caba1af51b2df65ab": {"model_name": "DescriptionStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "DescriptionStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": ""}}, "215696bcedd84fd8a6dd311f79365aa5": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HTMLView", "description": "", "description_tooltip": null, "layout": "IPY_MODEL_4cf7707cc5b9461093ead9fb2ae9e66c", "placeholder": "\u200b", "style": "IPY_MODEL_18c3d5f5ee774b4caba1af51b2df65ab", "value": " 3.35k/? [00:00&lt;00:00, 38.2kB/s]"}}, "c19be3a9dcdf4cdca8ff44a4ed6f8de1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "dc709e26d02e468f86dd3a517c8dee6d": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_7128770925c6446bab7f6d0a676b4159", "IPY_MODEL_215696bcedd84fd8a6dd311f79365aa5"], "layout": "IPY_MODEL_c19be3a9dcdf4cdca8ff44a4ed6f8de1"}}}, "version_major": 2, "version_minor": 0}
</script>

